?rbinom
rbinom(x, .39, 10000)
rbinom(poll.size, poll.probability, poll.generation)
#######################################################################
#Lab 10
#Jake Schneider
#######################################################################
poll.size <- 1004
poll.probability <- .39
poll.generation <- 10000
rbinom(poll.size, poll.probability, poll.generation)
simulation.polls <- rbinom(poll.size, poll.probability, poll.generation)
#######################################################################
#Lab 10
#Jake Schneider
#######################################################################
poll.size <- 1004
poll.probability <- 0.39
poll.generation <- 10000
simulation.polls <- rbinom(poll.size, poll.probability, poll.generation)
#######################################################################
#Lab 10
#Jake Schneider
#######################################################################
poll.size <- 1004
poll.probability <- 0.39
poll.generation <- 10000
simulation.polls <- rbinom(poll.generation, poll.size, poll.probability)
simulation.pools
simulation.polls
sampling.distribution.plot1 <- ggplot(simulation.polls, aes(x = Mean)) +
geom_histogram(aes(y = after_stat(density)), bins = 30, fill = "blue", alpha = 0.6) +
geom_density(color = "red", linewidth = 1) +
labs(title = "Sampling Distribution of Sample Mean", x = "Sample Mean", y = "Density")
#######################################################################
#Lab 10
#Jake Schneider
#######################################################################
library(tidyverse)
library(patchwork)
poll.size <- 1004
poll.probability <- 0.39
poll.generation <- 10000
simulation.polls <- rbinom(poll.generation, poll.size, poll.probability)
sampling.distribution.plot1 <- ggplot(simulation.polls, aes(x = Mean)) +
geom_histogram(aes(y = after_stat(density)), bins = 30, fill = "blue", alpha = 0.6) +
geom_density(color = "red", linewidth = 1) +
labs(title = "Sampling Distribution of Sample Mean", x = "Sample Mean", y = "Density")
hist(simulation.polls, probability = TRUE,
breaks = 50, main = "Sampling Distribution (n = 2008)",
xlab = "Sample Proportion", col = "lightgreen", border = "white")
lines(density(sample_props_2), col = "darkgreen", lwd = 2)
lines(density(simulation.polls), col = "darkgreen", lwd = 2)
poll.size <- 1004
poll.probability <- 0.39
poll.generation <- 10000
simulation.polls <- rbinom(poll.generation, poll.size, poll.probability) / poll.size
#######################################################################
#Lab 10
#Jake Schneider
#######################################################################
library(tidyverse)
library(patchwork)
poll.size <- 1004
poll.probability <- 0.39
poll.generation <- 10000
simulation.polls <- rbinom(poll.generation, poll.size, poll.probability) / poll.size
simulation1.poll.dat <- tibble(
prop = rbinom(poll.generation, poll.size, poll.probability) / poll.size
)
ggplot(simulation1.poll.dat, aes(x = prop)) +
geom_histogram(aes(y = ..density..), bins = 50, fill = "skyblue", color = "white") +
geom_density(color = "darkblue", linewidth = 1) +
labs(
title = paste("Sampling Distribution (n =", n, ")"),
subtitle = paste0("95% CI: [", round(ci[1], 3), ", ", round(ci[2], 3), "]",
" | MOE ≈ ±", round(moe * 100, 2), "%"),
x = "Sample Proportion",
y = "Density"
) +
theme_minimal()
ggplot(simulation1.poll.dat, aes(x = prop)) +
geom_histogram(aes(y = after_stat(density)), bins = 30, fill = "blue", alpha = 0.6) +
geom_density(color = "red", linewidth = 1) +
labs(title = "Sampling Distribution of Sample Mean", x = "Sample Mean", y = "Density")
################
#sample size 20000
poll.size <- 1004
poll.probability <- 0.39
poll.generation <- 20000
simulation1.poll.dat <- tibble(
prop = rbinom(poll.generation, poll.size, poll.probability) / poll.size
)
ggplot(simulation1.poll.dat, aes(x = prop)) +
geom_histogram(aes(y = after_stat(density)), bins = 30, fill = "blue", alpha = 0.6) +
geom_density(color = "red", linewidth = 1) +
labs(title = "Sampling Distribution of Sample Mean", x = "Sample Mean", y = "Density")
##################################################
#Task 1
#################################################
################
#sample size 10000
poll.size <- 1004
poll.probability <- 0.39
poll.generation <- 10000
simulation1.poll.dat <- tibble(
prop = rbinom(poll.generation, poll.size, poll.probability) / poll.size
)
ggplot(simulation1.poll.dat, aes(x = prop)) +
geom_histogram(aes(y = after_stat(density)), bins = 30, fill = "blue", alpha = 0.6) +
geom_density(color = "red", linewidth = 1) +
labs(title = "Sampling Distribution of Sample Mean", x = "Sample Mean", y = "Density")
ggplot(simulation1.poll.dat, aes(x = prop)) +
geom_histogram(aes(y = after_stat(density)), bins = 40, fill = "blue", alpha = 0.6) +
geom_density(color = "red", linewidth = 1) +
labs(title = "Sampling Distribution of Sample Mean", x = "Sample Mean", y = "Density")
ggplot(simulation1.poll.dat, aes(x = prop)) +
geom_histogram(aes(y = after_stat(density)), bins = 20, fill = "blue", alpha = 0.6) +
geom_density(color = "red", linewidth = 1) +
labs(title = "Sampling Distribution of Sample Mean", x = "Sample Mean", y = "Density")
################
#sample size 20000
poll.size <- 1004
poll.probability <- 0.39
poll.generation <- 20000
simulation1.poll.dat <- tibble(
prop = rbinom(poll.generation, poll.size, poll.probability) / poll.size
)
ggplot(simulation1.poll.dat, aes(x = prop)) +
geom_histogram(aes(y = after_stat(density)), bins = 20, fill = "blue", alpha = 0.6) +
geom_density(color = "red", linewidth = 1) +
labs(title = "Sampling Distribution of Sample Mean", x = "Sample Mean", y = "Density")
################
#poll size is 2008
poll.size <- 2008
poll.probability <- 0.39
poll.generation <- 10000
simulation1.poll.dat <- tibble(
prop = rbinom(poll.generation, poll.size, poll.probability) / poll.size
)
ggplot(simulation1.poll.dat, aes(x = prop)) +
geom_histogram(aes(y = after_stat(density)), bins = 20, fill = "blue", alpha = 0.6) +
geom_density(color = "red", linewidth = 1) +
labs(title = "Sampling Distribution of Sample Mean", x = "Sample Mean", y = "Density")
ci2 <- quantile(simulation1.poll.dat$prop, probs = c(0.025, 0.975))
moe2 <- (ci2[2] - ci2[1]) / 2
samp.size <- 1000
resample <- sample(x = 1:samp.size,
size = samp.size,
replace = T)
resample
##################################################
#Task 2
#################################################
gallup.survery <- tibble(
reponse = c(
rep("satisfied", 392),
rep("dissatisfied", 592),
rep("no.opinion", 20)
)
)
view(gallup.survery)
R <- 1000
resamples <- tibble(p.hat = numeric(R))
for( i in 1:R){
# Take a resample
curr.resample <- sample(x = gallup.survery$reponse,
size = nrow(gallup.survery),
replace = T)
# compute the stat on the resample
resamples$p.hat[i] <- mean(curr.resample == "satisfied")
}
ggplot(resamples) +
# geom_histogram(aes(x=p.hat, y=after_stat(density)),
#                    breaks=seq(-0.5,12.5,1)/12,
#                color="grey")+
geom_bar(aes(x=p.hat, y=after_stat(count/sum(count))))+
geom_hline(yintercept=0)+
theme_bw()+
xlab(bquote(hat(p)))+
ylab("Density")+
scale_x_continuous(breaks=round(seq(0,12,1)/12,2))
ggplot(resamples) +
# geom_histogram(aes(x=p.hat, y=after_stat(density)),
#                    breaks=seq(-0.5,12.5,1)/12,
#                color="grey")+
geom_bar(aes(x=p.hat, y=after_stat(count/sum(count))))+
geom_hline(yintercept=0)+
theme_bw()+
xlab(bquote(hat(p)))+
ylab("Density")+
scale_x_continuous(breaks=seq(30:50),by=1)
ggplot(resamples) +
# geom_histogram(aes(x=p.hat, y=after_stat(density)),
#                    breaks=seq(-0.5,12.5,1)/12,
# geom_histogram(aes(x=p.hat, y=after_stat(density)),
#                    breaks=seq(-0.5,12.5,1)/12,
#                color="grey")+
geom_bar(aes(x=p.hat, y=after_stat(count/sum(count))))+
theme_bw()+
ylab("Density")+
ggplot(resamples, aes(x = p.hat)) +
geom_histogram(aes(y = after_stat(density)),
bins = 30,
fill = "skyblue", color = "white") +
geom_density(color = "darkblue", linewidth = 1) +
geom_hline(yintercept = 0) +
theme_bw() +
xlab(expression(hat(p))) +
ylab("Density") +
scale_x_continuous(breaks = seq(0.30, 0.50, by = 0.01))
ggplot(resamples) +
# geom_histogram(aes(x=p.hat, y=after_stat(density)),
#                    breaks=seq(-0.5,12.5,1)/12,
#                color="grey")+
geom_bar(aes(x=p.hat, y=after_stat(count/sum(count))))+
geom_hline(yintercept=0)+
theme_bw()+
xlab(bquote(hat(p)))+
ylab("Density")+
scale_x_continuous(breaks=round(seq(.3,.5,.01)))
ggplot(resamples) +
# geom_histogram(aes(x=p.hat, y=after_stat(density)),
#                    breaks=seq(-0.5,12.5,1)/12,
#                color="grey")+
geom_bar(aes(x=p.hat, y=after_stat(count/sum(count))))+
geom_hline(yintercept=0)+
theme_bw()+
xlab(bquote(hat(p)))+
ylab("Density")+
scale_x_continuous(breaks=round(seq(.3,.5,.01)))+
geom_density(color = "red", linewidth = 1)
ggplot(resamples, aes(x = p.hat)) +
geom_bar(aes(y = after_stat(count / sum(count))),
fill = "lightblue", color = "white", width = 0.005) +
geom_density(color = "red", linewidth = 1) +
geom_hline(yintercept = 0) +
theme_bw() +
xlab(bquote(hat(p))) +
ylab("Density") +
scale_x_continuous(breaks = round(seq(0.3, 0.5, 0.01), 2))
ggplot(resamples) +
# geom_histogram(aes(x=p.hat, y=after_stat(density)),
#                    breaks=seq(-0.5,12.5,1)/12,
#                color="grey")+
geom_bar(aes(x=p.hat, y=after_stat(count/sum(count))))+
geom_hline(yintercept=0)+
theme_bw()+
xlab(bquote(hat(p)))+
ylab("Density")+
scale_x_continuous(breaks=round(seq(.3,.5,.01)))+
geom_density(color = "red", linewidth = 1) +
geom_hline(yintercept = 0) +
theme_bw() +
xlab(bquote(hat(p))) +
ylab("Density") +
scale_x_continuous(breaks = round(seq(0.3, 0.5, 0.01), 2))
ggplot(resamples, aes(x = p.hat)) +
geom_bar(aes(y = after_stat(count / sum(count))),
fill = "lightblue", color = "white", width = 0.005) +
geom_density(color = "red", linewidth = 1) +
geom_hline(yintercept = 0) +
theme_bw() +
xlab(bquote(hat(p))) +
ylab("Density") +
scale_x_continuous(breaks = round(seq(0.3, 0.5, 0.01), 2))
ggplot(resamples, aes(x = p.hat)) +
geom_bar(aes(y = after_stat(count / sum(count))),
fill = "lightblue", color = "gray", width = 0.005) +
geom_density(color = "red", linewidth = 1) +
geom_hline(yintercept = 0) +
theme_bw() +
xlab(bquote(hat(p))) +
ylab("Density") +
scale_x_continuous(breaks = round(seq(0.3, 0.5, 0.01), 2))
ggplot(resamples, aes(x = p.hat)) +
# Histogram underneath
geom_histogram(aes(y = after_stat(density)),
bins = 30, fill = "gray90", color = "gray70") +
# Bar chart of normalized counts on top
geom_bar(aes(y = after_stat(count / sum(count))),
fill = "lightblue", color = "white", width = 0.005) +
# Density curve on top
geom_density(color = "red", linewidth = 1) +
# Styling
geom_hline(yintercept = 0) +
theme_bw() +
xlab(bquote(hat(p))) +
ylab("Density") +
scale_x_continuous(breaks = round(seq(0.3, 0.5, 0.01), 2))
ci.3 <- quantile(resamples$p.hat, probs = c(0.025, 0.975))
moe.3 <- (ci2[2] - ci2[1]) / 2
ci.3
?expand_grid()
sim.grid <- expand_grid(n.values, p.values)
##################################################
#Task 3
#################################################
n.values <- seq(100,3000, 10)
p.values <- seq(.01,.99, .01)
simulation <- 10000
sim.grid <- expand_grid(n.values, p.values)
sim.grid <- expand_grid(n = n.values, p = p.values)
dim(sim.grid)
view(sim.grid)
n.p.sim.results <- sim.grid |>
rowwise() |>
mutate(
moe = {
props <- rbinom(n_sims, size = n, prob = p) / n
ci <- quantile(props, probs = c(0.025, 0.975))
(ci[2] - ci[1]) / 2
}
) |>
ungroup()
n.p.sim.results <- sim.grid |>
rowwise() |>
mutate(
moe = {
props <- rbinom(simulation.size, size = n, prob = p) / n
ci <- quantile(props, probs = c(0.025, 0.975))
(ci[2] - ci[1]) / 2
}
) |>
ungroup()
##################################################
#Task 3
#################################################
n.values <- seq(100,3000, 10)
p.values <- seq(.01,.99, .01)
simulation.size <- 10000
sim.grid <- expand_grid(n = n.values, p = p.values)
n.p.sim.results <- sim.grid |>
rowwise() |>
mutate(
moe = {
props <- rbinom(simulation.size, size = n, prob = p) / n
ci <- quantile(props, probs = c(0.025, 0.975))
(ci[2] - ci[1]) / 2
}
) |>
ungroup()
?geom_raster()
view(n.p.sim.results)
